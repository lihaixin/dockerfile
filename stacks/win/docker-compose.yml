services:
  windows:
    image: dockurr/windows                                                # https://github.com/dockur/windows
    container_name: win
    environment:
      VERSION: "${OS_V:-win7}"                                            # 系统标识  win7 ltsc10 win10
      DISK_SIZE: "${DISK_S:-30G}"                                         # 分配储存空间
      DISK_FMT: "${DISK_F:-qcow2}"                                        # 虚拟磁盘存储方式  ram | qcow2
      RAM_SIZE: "${MEM_S:-2G}"                                            # 分配的内存
      CPU_CORES: "${CPU_C:-2}"                                            # 分配的核心
      LANGUAGE: "${LANG:-Chinese}"                                        # 系统语言 English | Chinese
      # DHCP: "Y"                                                         # 注销这行开启路由器网段分配IP
      # ARGUMENTS: "-device usb-host,vendorid=0x232b,productid=0x0f13"    # 调用usb到容器 调整和上面lsusb输出一致，加0x表示为十六进制
    devices:
      - /dev/kvm
      # - /dev/bus/usb                                                    # 调用usb到容器
    # device_cgroup_rules:                                                # 注销这行开启路由器网段分配IP
    #   - 'c *:* rwm'                                                     # 注销这行开启路由器网段分配IP
    cap_add:
      - NET_ADMIN
    ports:
      - ${WEBVNC_PORT:-18006}:8006                                        # 和飞牛相册端口冲突
      - ${RDP_PORT:-13389}:3389/tcp                                       # 远程终端端口
      - ${RDP_PORT:-13389}:3389/udp                                       # 远程终端端口
    stop_grace_period: 2m
    volumes:
      - win:/storage
        ${BOOT_PATH_ARGS:-}
    # - /var/win11.iso:/custom.iso                                         # 自定义启动光盘文件
    networks:
      vlan:
        ipv4_address: "${IP:-172.19.0.13}"                                 # 修改不同的IP【*】
networks:
  vlan:
    external: true
volumes:
  win:
